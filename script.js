// Configurações
const config = {
    password: "minhaquerida2025",
    sections: {
        "inicio-namoro": [
            {
                type: "image",
                url: "media/inicio-namoro/1749498310927.jpg",
                caption: "✨ Nosso primeiro encontro"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310916.jpg",
                caption: "💑 Nosso primeiro beijo"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310904.jpg",
                caption: "❤️ Nosso primeiro abraço"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310892.jpg",
                caption: "💕 Nosso primeiro jantar"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310881.jpg",
                caption: "💖 Momentos especiais"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310869.jpg",
                caption: "💝 Nossos primeiros momentos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310857.jpg",
                caption: "💫 Memórias inesquecíveis"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310846.jpg",
                caption: "🌟 Momentos únicos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310822.jpg",
                caption: "💞 Nossa história"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310809.jpg",
                caption: "💗 Momentos de amor"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310786.jpg",
                caption: "💓 Nossos sorrisos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310773.jpg",
                caption: "💘 Momentos especiais"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310762.jpg",
                caption: "💖 Nossa conexão"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310750.jpg",
                caption: "💝 Nossos momentos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310701.jpg",
                caption: "💫 Nossa história de amor"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310687.jpg",
                caption: "🌟 Momentos únicos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310670.jpg",
                caption: "💑 Nossa jornada"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310605.jpg",
                caption: "💕 Nossos momentos juntos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310594.jpg",
                caption: "💖 Nossa história"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310581.jpg",
                caption: "💗 Momentos de amor"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310570.jpg",
                caption: "💓 Nossos sorrisos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310558.jpg",
                caption: "💘 Momentos especiais"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310545.jpg",
                caption: "💖 Nossa conexão"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310535.jpg",
                caption: "💝 Nossos momentos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310521.jpg",
                caption: "💫 Nossa história de amor"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310509.jpg",
                caption: "🌟 Momentos únicos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310496.jpg",
                caption: "💑 Nossa jornada"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310483.jpg",
                caption: "💕 Nossos momentos juntos"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310472.jpg",
                caption: "💖 Nossa história"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310461.jpg",
                caption: "💗 Momentos de amor"
            },
            {
                type: "image",
                url: "media/inicio-namoro/1749498310449.jpg",
                caption: "💓 Nossos sorrisos"
            }
        ],
        "roles": [
            {
                type: "image",
                url: "media/roles/1749498621048.jpg",
                caption: "🎉 Nosso primeiro rolê"
            },
            {
                type: "image",
                url: "media/roles/1749498621004.jpg",
                caption: "🎊 Momentos especiais"
            },
            {
                type: "image",
                url: "media/roles/1749498620995.jpg",
                caption: "💫 Nossas aventuras"
            },
            {
                type: "image",
                url: "media/roles/1749498621217.jpg",
                caption: "🌟 Momentos únicos"
            },
            {
                type: "image",
                url: "media/roles/1749498621015.jpg",
                caption: "💖 Nossa história"
            },
            {
                type: "image",
                url: "media/roles/1749498621027.jpg",
                caption: "💗 Momentos de amor"
            },
            {
                type: "image",
                url: "media/roles/1749498621161.jpg",
                caption: "💓 Nossos sorrisos"
            },
            {
                type: "image",
                url: "media/roles/1749498621205.jpg",
                caption: "💘 Momentos especiais"
            },
            {
                type: "image",
                url: "media/roles/1749498621187.jpg",
                caption: "💖 Nossa conexão"
            },
            {
                type: "image",
                url: "media/roles/1749498621147.jpg",
                caption: "💝 Nossos momentos"
            },
            {
                type: "image",
                url: "media/roles/1749498621059.jpg",
                caption: "💫 Nossa história de amor"
            },
            {
                type: "image",
                url: "media/roles/1749498621136.jpg",
                caption: "🌟 Momentos únicos"
            },
            {
                type: "image",
                url: "media/roles/1749498621174.jpg",
                caption: "💑 Nossa jornada"
            },
            {
                type: "image",
                url: "media/roles/1749498621127.jpg",
                caption: "💕 Nossos momentos juntos"
            },
            {
                type: "image",
                url: "media/roles/1749498621114.jpg",
                caption: "💖 Nossa história"
            },
            {
                type: "image",
                url: "media/roles/1749498621104.jpg",
                caption: "💗 Momentos de amor"
            },
            {
                type: "image",
                url: "media/roles/1749498621083.jpg",
                caption: "💓 Nossos sorrisos"
            },
            {
                type: "image",
                url: "media/roles/1749498621092.jpg",
                caption: "💘 Momentos inesquecíveis"
            }
        ],
        "treinos": [
            {
                type: "image",
                url: "media/treinos/1749498390954.jpg",
                caption: "💪 Treino em dupla"
            },
            {
                type: "image",
                url: "media/treinos/1749498390935.jpg",
                caption: "💑 Motivação mútua"
            },
            {
                type: "image",
                url: "media/treinos/1749498390926.jpg",
                caption: "❤️ Treinando juntos"
            },
            {
                type: "image",
                url: "media/treinos/1749498390916 (1).jpg",
                caption: "💕 Cada dia mais fortes"
            }
        ],
        "viagens": [
            {
                type: "image",
                url: "media/viagens/1749498487351.jpg",
                caption: "✈️ Nossa primeira viagem juntos"
            },
            {
                type: "video",
                url: "media/viagens/VID_172620612_062854_148.mp4",
                caption: "🎥 Momentos especiais"
            },
            {
                type: "image",
                url: "media/viagens/1749498487264.jpg",
                caption: "🌅 Pôr do sol romântico"
            },
            {
                type: "image",
                url: "media/viagens/1749498487273.jpg",
                caption: "🏖️ Praia e amor"
            },
            {
                type: "image",
                url: "media/viagens/1749498487361.jpg",
                caption: "🌴 Aventuras juntos"
            },
            {
                type: "image",
                url: "media/viagens/1749498487254.jpg",
                caption: "💑 Memórias inesquecíveis"
            },
            {
                type: "image",
                url: "media/viagens/1749498487321.jpg",
                caption: "🌊 Momentos de paz"
            },
            {
                type: "image",
                url: "media/viagens/1749498487312.jpg",
                caption: "❤️ Cada viagem é especial"
            },
            {
                type: "image",
                url: "media/viagens/1749498487283.jpg",
                caption: "🌅 Novos horizontes"
            },
            {
                type: "image",
                url: "media/viagens/1749498487293.jpg",
                caption: "💕 Aventuras românticas"
            },
            {
                type: "image",
                url: "media/viagens/1749498487302.jpg",
                caption: "🌴 Lugares especiais"
            },
            {
                type: "image",
                url: "media/viagens/1749498487341.jpg",
                caption: "✈️ Juntos em cada destino"
            }
        ],
        "momentos": [
            {
                type: "video",
                url: "media/momentos/VID_20250118_174135.mp4",
                caption: "🎥 Momentos especiais juntos"
            },
            {
                type: "image",
                url: "media/momentos/1749498696527.jpg",
                caption: "💕 Cada momento é especial"
            },
            {
                type: "image",
                url: "media/momentos/1749498696516.jpg",
                caption: "❤️ Memórias inesquecíveis"
            },
            {
                type: "image",
                url: "media/momentos/1749498696537.jpg",
                caption: "💑 Juntos em cada momento"
            },
            {
                type: "image",
                url: "media/momentos/1749498696558.jpg",
                caption: "🌹 Momentos de amor"
            },
            {
                type: "image",
                url: "media/momentos/1749498696604.jpg",
                caption: "💝 Cada dia mais feliz"
            },
            {
                type: "image",
                url: "media/momentos/1749498696549.jpg",
                caption: "💖 Momentos únicos"
            },
            {
                type: "image",
                url: "media/momentos/1749498696594.jpg",
                caption: "💗 Nossa história"
            },
            {
                type: "image",
                url: "media/momentos/1749498696640.jpg",
                caption: "💓 Momentos de alegria"
            },
            {
                type: "image",
                url: "media/momentos/1749498696569.jpg",
                caption: "💘 Cada sorriso é especial"
            },
            {
                type: "image",
                url: "media/momentos/1749498696581.jpg",
                caption: "💞 Momentos de carinho"
            },
            {
                type: "image",
                url: "media/momentos/1749498696626.jpg",
                caption: "💟 Nossa jornada"
            },
            {
                type: "image",
                url: "media/momentos/1749498696616.jpg",
                caption: "💝 Momentos de ternura"
            },
            {
                type: "image",
                url: "media/momentos/1749498696663.jpg",
                caption: "💖 Cada instante juntos"
            },
            {
                type: "video",
                url: "media/momentos/VID-20250315-WA0020.mp4",
                caption: "🎥 Momentos de felicidade"
            },
            {
                type: "image",
                url: "media/momentos/1749498696651.jpg",
                caption: "💕 Nossa história de amor"
            },
            {
                type: "image",
                url: "media/momentos/1749498696766.jpg",
                caption: "💑 Momentos especiais"
            },
            {
                type: "image",
                url: "media/momentos/1749498696739.jpg",
                caption: "❤️ Cada dia mais feliz"
            },
            {
                type: "image",
                url: "media/momentos/1749498696827.jpg",
                caption: "💗 Momentos de amor"
            },
            {
                type: "image",
                url: "media/momentos/1749498696852.jpg",
                caption: "💓 Nossa jornada juntos"
            },
            {
                type: "image",
                url: "media/momentos/1749498696816.jpg",
                caption: "💘 Momentos únicos"
            },
            {
                type: "image",
                url: "media/momentos/1749498696840.jpg",
                caption: "💞 Cada sorriso é especial"
            },
            {
                type: "image",
                url: "media/momentos/1749498696940.jpg",
                caption: "💟 Momentos de carinho"
            },
            {
                type: "image",
                url: "media/momentos/1749498696864.jpg",
                caption: "💝 Nossa história"
            },
            {
                type: "image",
                url: "media/momentos/1749498696897.jpg",
                caption: "💖 Momentos de ternura"
            },
            {
                type: "image",
                url: "media/momentos/1749498696886.jpg",
                caption: "💕 Cada instante juntos"
            },
            {
                type: "image",
                url: "media/momentos/1749498696909.jpg",
                caption: "💑 Momentos de alegria"
            },
            {
                type: "image",
                url: "media/momentos/1749498696919.jpg",
                caption: "❤️ Nossa história de amor"
            },
            {
                type: "image",
                url: "media/momentos/1749498696931.jpg",
                caption: "💗 Momentos especiais"
            },
            {
                type: "image",
                url: "media/momentos/1749498696952.jpg",
                caption: "💓 Cada dia mais feliz"
            }
        ]
    }
};

// Elementos do DOM (modal elements will be created dynamically)
const elements = {
    loginScreen: document.getElementById('login-screen'),
    mainContent: document.getElementById('main-content'),
    passwordInput: document.getElementById('password-input'),
    loginButton: document.getElementById('login-button'),
    errorMessage: document.getElementById('error-message'),
    menuToggle: document.querySelector('.menu-toggle'),
    navList: document.querySelector('.nav-list'),
    contentSections: document.querySelectorAll('.content-section'),
    // Remove modal-related elements from initial DOM query as they are dynamic
    modal: null,
    modalContent: null,
    modalClose: null
};

// Estado da aplicação
const state = {
    isLoggedIn: false,
    isMenuOpen: false,
    currentImageIndex: 0,
    isModalOpen: false,
    currentSection: 'inicio-namoro',
    touchStartX: 0,
    touchEndX: 0
};

// Funções de Utilidade
function showError(message) {
    elements.errorMessage.textContent = message;
    elements.errorMessage.style.display = 'block';
    elements.errorMessage.style.animation = 'shake 0.5s ease-in-out';
    setTimeout(() => {
        elements.errorMessage.style.animation = '';
    }, 500);
}

function hideError() {
    elements.errorMessage.style.display = 'none';
}

// Funções de Login
function initLoginEvents() {
    if (elements.loginButton) {
        elements.loginButton.addEventListener('click', validatePassword);
    }
    if (elements.passwordInput) {
        elements.passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') validatePassword();
        });
    }
}

function validatePassword() {
    const password = elements.passwordInput.value.trim();
    console.log('Validando senha:', password);
    
    // Remove barras e hifens para normalizar o formato
    const normalizedPassword = password.replace(/[\/\-]/g, '');
    console.log('Senha normalizada:', normalizedPassword);
    
    // Lista de variações válidas da data
    const validDates = [
        '21022024', // 21/02/2024 ou 21-02-2024
        '210224'    // 21/02/24 ou 21-02-24
    ];
    
    console.log('Datas válidas:', validDates);
    console.log('Senha está na lista?', validDates.includes(normalizedPassword));
    
    if (validDates.includes(normalizedPassword)) {
        console.log('Senha correta!');
        hideError();
        elements.loginScreen.style.opacity = '0';
        elements.loginScreen.style.visibility = 'hidden';
        elements.mainContent.style.opacity = '1';
        elements.mainContent.style.visibility = 'visible';
        state.isLoggedIn = true;
        initAlbum(); // Chama initAlbum aqui para carregar o conteúdo após o login
    } else {
        console.log('Senha incorreta!');
        showError('Data incorreta. Tente novamente.');
        elements.passwordInput.value = '';
        elements.passwordInput.focus();
    }
}

// Funções do Menu
function toggleMenu() {
    state.isMenuOpen = !state.isMenuOpen;
    if (elements.menuToggle) elements.menuToggle.classList.toggle('active');
    if (elements.navList) elements.navList.classList.toggle('active');
    document.body.style.overflow = state.isMenuOpen ? 'hidden' : '';
}

function closeMenu() {
    if (elements.navList) elements.navList.classList.remove('active');
    if (elements.menuToggle) elements.menuToggle.classList.remove('active');
    state.isMenuOpen = false;
    document.body.style.overflow = '';
}

function initMenuEvents() {
    if (elements.menuToggle) {
        elements.menuToggle.addEventListener('click', toggleMenu);
    }
    if (elements.navList) {
        elements.navList.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = link.getAttribute('data-section');
                navigateTo(sectionId);
                // No need to explicitly closeMenu() here as navigateTo does it for small screens
            });
        });
    }
}

function initMenuCloseListeners() {
    document.addEventListener('click', (e) => {
        if (state.isMenuOpen && elements.navList && !elements.navList.contains(e.target) && !elements.menuToggle.contains(e.target)) {
            closeMenu();
        }
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && state.isMenuOpen) {
            closeMenu();
        }
    });

    window.addEventListener('resize', () => {
        if (window.innerWidth > 768 && state.isMenuOpen) {
            closeMenu();
        }
    });
}

// Funções de Navegação
function navigateTo(sectionId) {
    // Esconde todas as seções e remove a classe active
    elements.contentSections.forEach(section => {
        section.style.opacity = '0';
        section.style.visibility = 'hidden';
        section.classList.remove('active');
    });

    // Remove a classe active de todos os links do menu
    if (elements.navList) {
        elements.navList.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });
    }

    // Adiciona a classe active na seção e link selecionados
    const selectedSection = document.getElementById(sectionId);
    const selectedLink = document.querySelector(`.nav-link[data-section="${sectionId}"]`);
    
    if (selectedSection) {
        selectedSection.style.opacity = '1';
        selectedSection.style.visibility = 'visible';
        selectedSection.classList.add('active');
    }
    
    if (selectedLink) {
        selectedLink.classList.add('active');
    }

    state.currentSection = sectionId;

    // Fecha o menu se for mobile
    if (window.innerWidth <= 768 && state.isMenuOpen) {
        closeMenu();
    }
}

// Funções do Álbum
function createMediaCard(media) {
    const mediaCard = document.createElement('div');
    mediaCard.className = 'media-card';
    mediaCard.setAttribute('data-index', state.currentImageIndex); // Adiciona o índice para navegação

    const mediaContainer = document.createElement('div');
    mediaContainer.className = 'media-container';

    if (media.type === 'image') {
        const img = document.createElement('img');
        img.src = media.url;
        img.alt = media.caption;
        img.className = 'media-image';
        img.loading = 'lazy'; // Lazy loading para otimização
        img.onerror = function() {
            this.onerror=null; // Evita loop infinito de erro
            const errorContainer = document.createElement('div');
            errorContainer.className = 'error-container';
            errorContainer.innerHTML = `
                <span class="error-message">❌ Imagem não disponível</span>
                <p class="error-caption">${media.caption}</p>
            `;
            mediaContainer.innerHTML = ''; // Limpa a imagem quebrada
            mediaContainer.appendChild(errorContainer);
        };
        mediaContainer.appendChild(img);
    } else if (media.type === 'video') {
        const video = document.createElement('video');
        video.src = media.url;
        video.controls = false; // Controlado pelo modal
        video.muted = true;
        video.loop = true;
        video.preload = 'metadata'; // Carrega metadados para thumbnail
        video.className = 'media-image';
        
        // Adiciona um ícone de play visual para vídeos
        const playIcon = document.createElement('div');
        playIcon.className = 'play-icon';
        playIcon.innerHTML = '<i class="fas fa-play"></i>'; // Exemplo com Font Awesome
        mediaContainer.appendChild(video);
        mediaContainer.appendChild(playIcon);

        video.addEventListener('loadeddata', function() {
            if (this.duration) {
                this.currentTime = Math.min(1, this.duration / 2); // Tenta um frame no meio ou 1s
            }
        });
    }

    const caption = document.createElement('p');
    caption.className = 'media-caption';
    caption.textContent = media.caption;
    mediaCard.appendChild(mediaContainer);
    mediaCard.appendChild(caption);

    mediaCard.addEventListener('click', () => {
        openModal(media);
    });

    return mediaCard;
}

function initAlbum() {
    for (const sectionId in config.sections) {
        if (config.sections.hasOwnProperty(sectionId)) {
            const sectionData = config.sections[sectionId];
            const galleryGrid = document.querySelector(`#${sectionId} .gallery-grid`);
            if (galleryGrid) {
                galleryGrid.innerHTML = ''; // Limpa o conteúdo existente
                sectionData.forEach((media, index) => {
                    state.currentImageIndex = index; // Define o índice da imagem ao criar o cartão
                    galleryGrid.appendChild(createMediaCard(media));
                });
            }
        }
    }
}

// Funções do Modal
function openModal(item) {
    state.currentImageIndex = config.sections[state.currentSection].indexOf(item); // Garante que o índice esteja correto
    state.isModalOpen = true;
    document.body.style.overflow = 'hidden';

    // Cria os elementos da modal dinamicamente
    const modal = document.createElement('div');
    modal.id = 'modal';
    modal.className = 'modal';

    const modalContent = document.createElement('div');
    modalContent.id = 'modal-content';
    modalContent.className = 'modal-content';

    const modalCloseButton = document.createElement('button');
    modalCloseButton.id = 'modal-close';
    modalCloseButton.className = 'modal-close';
    modalCloseButton.innerHTML = '&times;';
    
    // Adiciona event listeners diretamente aos elementos criados dinamicamente
    modalCloseButton.addEventListener('click', closeModal); 
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModal();
        }
    });

    if (item.type === 'image') {
        const img = document.createElement('img');
        img.src = item.url;
        img.alt = item.caption;
        img.className = 'modal-image';
        modalContent.appendChild(img);
    } else if (item.type === 'video') {
        const video = document.createElement('video');
        video.src = item.url;
        video.controls = true;
        video.autoplay = true;
        video.loop = true;
        video.className = 'modal-video';
        modalContent.appendChild(video);
    }

    const caption = document.createElement('p');
    caption.className = 'modal-caption';
    caption.textContent = item.caption;
    modalContent.appendChild(caption);

    modal.appendChild(modalContent);
    modal.appendChild(modalCloseButton); // Adiciona o botão de fechar à modal

    document.body.appendChild(modal);

    // Atualiza references in elements object for use by other functions (e.g., navigateModal)
    elements.modal = modal;
    elements.modalContent = modalContent;
    elements.modalClose = modalCloseButton;

    // Adiciona listener para navegação com setas do teclado
    document.addEventListener('keydown', handleModalNavigation);
}

function closeModal() {
    state.isModalOpen = false;
    document.body.style.overflow = '';
    if (elements.modal && elements.modal.parentNode) {
        elements.modal.parentNode.removeChild(elements.modal);
    }
    document.removeEventListener('keydown', handleModalNavigation);
    // Clear global references after closing
    elements.modal = null;
    elements.modalContent = null;
    elements.modalClose = null;
}

function handleModalNavigation(e) {
    if (state.isModalOpen) {
        if (e.key === 'ArrowLeft') {
            navigateModal(-1);
        } else if (e.key === 'ArrowRight') {
            navigateModal(1);
        } else if (e.key === 'Escape') {
            closeModal();
        }
    }
}

function navigateModal(direction) {
    const currentSection = state.currentSection;
    const items = config.sections[currentSection];
    const newIndex = (state.currentImageIndex + direction + items.length) % items.length;
    state.currentImageIndex = newIndex; // Atualiza o índice da imagem atual
    
    const currentItem = items[newIndex];

    // Atualiza o conteúdo da modal
    if (elements.modalContent) {
        elements.modalContent.innerHTML = ''; // Limpa o conteúdo existente

        if (currentItem.type === 'image') {
            const img = document.createElement('img');
            img.src = currentItem.url;
            img.alt = currentItem.caption;
            img.className = 'modal-image';
            elements.modalContent.appendChild(img);
        } else if (currentItem.type === 'video') {
            const video = document.createElement('video');
            video.src = currentItem.url;
            video.controls = true;
            video.autoplay = true;
            video.loop = true;
            video.className = 'modal-video';
            elements.modalContent.appendChild(video);
        }

        const caption = document.createElement('p');
        caption.className = 'modal-caption';
        caption.textContent = currentItem.caption;
        elements.modalContent.appendChild(caption);
    } else {
        console.error("Erro: elements.modalContent é null em navigateModal.");
    }
}

// Inicialização Principal
function initDOMElements() {
    elements.loginScreen = document.getElementById('login-screen');
    elements.mainContent = document.getElementById('main-content');
    elements.passwordInput = document.getElementById('password-input');
    elements.loginButton = document.getElementById('login-button');
    elements.errorMessage = document.getElementById('error-message');
    elements.menuToggle = document.querySelector('.menu-toggle');
    elements.navList = document.querySelector('.nav-list');
    elements.contentSections = document.querySelectorAll('.content-section');

    // Adiciona verificação para elementos essenciais
    if (!elements.loginScreen || !elements.mainContent) {
        console.error("Erro: Elementos essenciais do DOM (loginScreen ou mainContent) não encontrados.");
    }
}

document.addEventListener('DOMContentLoaded', () => {
    initDOMElements();
    initLoginEvents();
    initMenuEvents();
    initMenuCloseListeners();

    // Se já estiver logado (para casos de recarregamento sem logout, ou se a sessão for mantida)
    // Nota: Em um ambiente real, você usaria localStorage ou cookies para persistir o login.
    if (state.isLoggedIn) {
        elements.loginScreen.style.display = 'none';
        elements.mainContent.style.display = 'block';
        initAlbum(); // Garante que o álbum seja inicializado se já estiver logado
    }
}); 
